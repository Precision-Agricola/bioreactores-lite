<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Bio-Reactor Control</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-color: #1e1e1e;
            --text-color: #e0e0e0;
            --primary-color: #8ec742;
            --secondary-color: #459a47;
            --accent-color: #008745;
            --off-color: #f44336;
            --border-color: #333;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        main {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 10px;
        }

        .bioreactor-logo {
            width: 120px;
            height: 120px;
            margin-bottom: 10px;
            color: white;
        }
        
        .header-title {
            margin: 0;
            font-size: 1.8em;
            color: white;  
            font-weight: 700;
        }

        .header-subtitle {
            margin: 5px 0 15px 0;
            color: #aaa;
            font-size: 1.1em;
        }

        .company-logo {
            width: 180px;
            height: auto;
        }

        .card {
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .card h2, .card h3 {
            margin-top: 0;
            font-size: 1.1em;
            color: var(--secondary-color);
            border-bottom: 1px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        /* h3 más pequeño para los sensores */
        .card h3 {
            font-size: 1.0em;
            color: var(--text-color);
            border-bottom: none;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .status-item {
            text-align: center;
        }

        .status-text {
            font-size: 1.5em;
            font-weight: 700;
            margin: 0;
        }
        
        .status-value {
            font-size: 1.2em;
            font-weight: 400;
        }
        
        /* Unidad más pequeña para los sensores */
        .status-item .status-value {
            font-size: 0.9em;
            font-weight: 400;
            color: #aaa;
        }

        .status-on { color: var(--primary-color); }
        .status-off { color: var(--off-color); }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .control-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .aerator-status {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }
        
        .info-text {
            font-size: 0.9em;
            line-height: 1.6;
            color: #bbb;
        }
        
        .info-text strong {
            color: var(--secondary-color);
        }

        .btn {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            font-weight: 600;
            color: var(--secondary-color);
            background-color: transparent;
            border: 1px solid var(--secondary-color);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }
        .btn:hover {
            background-color: var(--secondary-color);
            color: var(--card-color);
        }

        /* ... (Estilos de .btn-reset, .switch, .slider, footer sin cambios) ... */
        .btn-reset {
            padding: 8px 12px;
            font-size: 0.9em;
            font-weight: 600;
            color: var(--secondary-color);
            background-color: transparent;
            border: 1px solid var(--secondary-color);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }
        .btn-reset:hover {
            background-color: var(--secondary-color);
            color: var(--card-color);
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px; width: 26px;
            left: 4px; bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        footer {
            text-align: center;
            font-size: 0.8em;
            color: #888;
            width: 100%;
            max-width: 400px;
        }
        input:checked + .slider { background-color: var(--primary-color); }
        input:focus + .slider { box-shadow: 0 0 1px var(--primary-color); }
        input:checked + .slider:before { transform: translateX(26px); }
        .slider.round { border-radius: 34px; }
        .slider.round:before { border-radius: 50%; }

    </style>
</head>
<body>
    <main>
        <header>
            <!-- 1. Logo del Producto -->
            <svg class="bioreactor-logo" version="1.0" xmlns="http://www.w3.org/2000/svg"
            width="300.000000pt" height="362.000000pt" viewBox="0 0 300.000000 362.000000"
            preserveAspectRatio="xMidYMid meet">
            <metadata>
            Created by potrace 1.10, written by Peter Selinger 2001-2011
            </metadata>
            <g transform="translate(0.000000,362.000000) scale(0.050000,-0.050000)"
            fill="#ffffff" stroke="none">
            <path d="M2104 7136 c-33 -33 -33 -519 0 -552 15 -15 85 -24 180 -24 l156 0 0
            -420 0 -420 -170 0 -170 0 0 150 c0 201 -22 216 -298 207 -243 -8 -249 -14
            -259 -208 l-7 -149 -88 0 -88 0 0 149 c0 198 -18 211 -284 211 -254 0 -276
            -18 -276 -220 0 -120 -5 -140 -35 -140 -381 -1 -520 -514 -189 -696 l84 -47 0
            -2328 c0 -2281 1 -2328 39 -2348 21 -12 128 -21 237 -21 275 0 264 -17 264
            427 0 194 4 353 8 353 4 0 47 -18 95 -40 136 -61 3078 -61 3214 0 48 22 91 40
            95 40 4 0 8 -155 8 -346 0 -451 -11 -434 280 -434 316 0 280 -305 280 2394 l0
            2305 55 29 c324 169 258 621 -103 702 l-102 23 -6 158 c-8 211 -6 209 -272
            209 -274 0 -272 1 -272 -214 l0 -166 -100 0 -100 0 0 291 c0 387 14 369 -277
            369 -300 0 -283 21 -283 -354 l0 -306 -170 0 -171 0 6 415 5 415 150 5 c209 8
            220 24 220 309 0 330 95 296 -837 296 -592 0 -801 -6 -819 -24z m1452 -271 l6
            -105 -266 -1 c-444 -1 -923 -1 -971 0 -41 1 -45 11 -45 111 l0 111 635 -6 635
            -5 6 -105z m-361 -730 l6 -415 -281 0 -280 0 0 421 0 420 275 -5 275 -6 5
            -415z m881 -180 l5 -235 -80 0 -81 0 0 241 0 241 75 -6 75 -6 6 -235z m754
            -135 l0 -90 -85 -6 -85 -6 0 88 c0 107 10 117 99 110 70 -6 71 -7 71 -96z
            m-3670 -20 c0 -80 0 -80 -80 -80 -80 0 -80 0 -80 80 0 80 0 80 80 80 80 0 80
            0 80 -80z m750 0 c0 -68 -2 -70 -85 -76 l-85 -6 0 82 0 82 85 -6 c83 -6 85 -8
            85 -76z m3250 -306 c104 -52 124 -190 39 -275 -38 -38 -75 -39 -2288 -39
            l-2248 0 -42 53 c-59 75 -53 158 17 229 l59 58 2206 0 c1739 -1 2218 -6 2257
            -26z m-4160 -2555 l0 -2041 -75 6 -75 6 -5 2010 c-6 2224 -13 2060 84 2060
            l71 0 0 -2041z m3615 1679 l-5 -362 -100 -38 c-591 -227 -1044 -213 -1777 54
            -586 214 -919 250 -1320 141 -108 -29 -200 -53 -205 -53 -14 0 -9 593 5 607 8
            7 777 13 1711 13 l1697 0 -6 -362z m360 -1683 l5 -2035 -80 0 -80 0 0 2027 c0
            1114 6 2033 14 2041 8 7 42 11 75 8 l61 -6 5 -2035z m-2805 1307 c99 -21 333
            -93 520 -161 713 -260 1164 -286 1736 -99 98 32 181 58 186 58 4 0 8 -441 8
            -980 l0 -980 -1710 0 -1710 0 5 1033 5 1033 109 37 c297 101 561 119 851 59z
            m2450 -2472 l0 -110 -1710 0 -1710 0 0 110 0 110 1710 0 1710 0 0 -110z m-9
            -365 c-20 -87 -76 -151 -172 -200 l-89 -46 -1460 6 c-1342 5 -1465 8 -1523 40
            -73 39 -138 123 -158 201 l-13 54 1714 0 1714 0 -13 -55z m-3611 -816 l0 -111
            -75 6 c-71 6 -75 10 -81 83 -9 111 5 133 85 133 l71 0 0 -111z m3980 1 l0
            -110 -80 0 -80 0 0 110 0 110 80 0 80 0 0 -110z"/>
            <path d="M1829 3953 c-238 -108 -251 -452 -21 -561 345 -164 616 304 308 534
            -66 49 -208 63 -287 27z m194 -206 c77 -69 25 -187 -82 -187 -68 0 -106 41
            -106 114 0 94 115 139 188 73z"/>
            <path d="M3961 3487 c-47 -60 -50 -85 -19 -154 66 -144 278 -94 278 66 0 135
            -175 194 -259 88z"/>
            <path d="M2830 3157 c-424 -156 -316 -779 134 -777 324 2 504 375 312 645 -80
            113 -312 181 -446 132z m230 -207 c73 -38 100 -86 100 -180 0 -172 -217 -256
            -342 -132 -168 169 29 422 242 312z"/>
            <path d="M1569 2911 c-94 -94 -32 -251 98 -251 70 0 153 82 153 150 0 29 -22
            74 -49 101 -27 27 -72 49 -101 49 -28 0 -74 -22 -101 -49z"/>
            <path d="M4040 2586 c-159 -59 -121 -286 47 -286 135 0 193 143 97 239 -60 60
            -85 68 -144 47z"/>
            </g>
            </svg>
                    
            <!-- 2. Título Comercial -->
            <h1 class="header-title">Biorreactor</h1>
            <h1 class="header-title">Inteligente</h1>
            <p class="header-subtitle">by</p>

            <!-- 3. Logo de la Empresa -->
            <svg class="company-logo" xmlns="http://www.w3.org/2000/svg" version="1.0" viewBox="0 0 2044.000000 752.000000" preserveAspectRatio="xMidYMid meet">
                <g transform="translate(0.000000,752.000000) scale(0.100000,-0.100000)" fill="#f1f5f9" stroke="none">
                    <path d="M2637 6287 c73 -89 171 -193 376 -403 87 -89 166 -172 175 -185 9 -13 24 -31 33 -39 29 -27 173 -202 216 -264 58 -85 188 -345 217 -438 35 -110 76 -298 76 -351 0 -42 -4 -50 -56 -101 -30 -31 -61 -56 -67 -56 -7 0 -19 -9 -27 -20 -8 -11 -18 -20 -23 -20 -15 0 -187 -155 -187 -168 0 -7 -4 -11 -8 -8 -7 4 -52 -38 -127 -117 -12 -12 -50 -56 -85 -97 -35 -41 -66 -77 -69 -80 -3 -3 -18 -21 -32 -40 -15 -19 -37 -47 -51 -61 -36 -39 -298 -420 -298 -434 0 -4 -9 -18 -20 -32 -11 -14 -20 -34 -20 -44 0 -11 -5 -19 -10 -19 -6 0 -20 -21 -31 -47 -11 -27 -44 -100 -73 -163 -180 -390 -277 -702 -321 -1035 -9 -66 -20 -149 -26 -185 -5 -36 -13 -188 -16 -338 -4 -166 -10 -275 -16 -279 -10 -6 -33 16 -117 118 -25 29 -65 76 -90 104 -25 27 -58 68 -73 90 -15 22 -47 62 -72 89 -24 27 -42 52 -40 56 3 5 -1 14 -8 22 -30 30 -207 307 -207 324 0 4 -6 15 -13 23 -12 13 -105 209 -152 316 -26 61 -94 253 -123 350 -45 149 -71 272 -97 450 -8 55 -20 134 -26 175 -6 41 -14 192 -16 335 -5 229 -3 279 16 420 32 234 74 418 134 585 153 421 399 778 878 1276 101 104 226 236 278 292 109 118 100 118 198 -1z m14838 10 c16 -12 17 -25 13 -108 -12 -219 -128 -432 -307 -565 -100 -74 -178 -115 -241 -126 -108 -19 -228 -31 -252 -25 -24 6 -27 13 -34 74 -9 84 8 213 40 297 40 106 87 178 172 261 64 64 99 90 176 128 52 25 121 53 154 61 78 19 254 21 279 3z m-1517 -402 c9 -3 12 -50 12 -186 0 -161 -2 -183 -17 -195 -21 -16 -389 -20 -413 -4 -12 8 -16 44 -18 202 l-4 193 214 -3 c117 -2 219 -5 226 -7z m-8253 -10 c187 -10 260 -25 378 -76 81 -35 189 -108 227 -153 47 -55 91 -139 122 -230 30 -88 31 -97 31 -271 0 -195 -9 -253 -60 -369 -85 -194 -214 -290 -473 -355 -70 -17 -376 -33 -577 -29 -100 1 -185 -1 -190 -6 -4 -4 -10 -193 -13 -419 l-5 -412 -219 -3 c-199 -2 -220 -1 -232 15 -11 15 -13 221 -14 1165 l0 1147 38 3 c51 5 863 -1 987 -7z m5853 -164 c2 -96 1 -185 -2 -197 l-6 -24 -220 0 -220 0 -2 60 c-1 33 -1 83 -1 110 0 28 0 91 1 140 l2 90 223 -2 222 -3 3 -174z m-3944 -410 c33 -13 39 -71 29 -271 l-8 -155 -45 -2 c-192 -11 -306 -41 -373 -100 -57 -50 -78 -96 -108 -238 -7 -29 -14 -245 -18 -515 l-6 -465 -195 0 c-107 0 -203 4 -212 7 -17 7 -18 57 -18 846 0 638 3 841 12 850 8 8 63 12 183 12 222 0 212 7 214 -142 0 -61 5 -116 9 -120 16 -16 40 3 79 60 42 61 124 143 175 175 43 26 172 65 220 66 20 1 48 -3 62 -8z m941 -1 c109 -10 244 -48 315 -88 69 -39 161 -116 198 -164 109 -143 137 -201 172 -351 28 -122 30 -393 3 -401 -10 -3 -276 -6 -590 -8 l-573 -3 0 -52 c0 -154 86 -306 205 -362 66 -31 117 -40 214 -36 111 4 172 32 255 117 67 69 55 66 286 71 164 4 200 -1 200 -30 0 -27 -66 -150 -111 -207 -81 -103 -165 -163 -323 -231 -108 -47 -362 -72 -466 -45 -25 6 -65 16 -90 21 -59 14 -171 58 -191 75 -8 8 -20 14 -25 14 -10 0 -81 49 -147 101 -46 35 -131 150 -156 209 -67 158 -90 332 -73 570 12 183 25 244 76 353 113 245 351 419 612 446 108 11 98 11 209 1z m4193 -10 c69 -12 182 -50 256 -87 63 -32 148 -113 181 -171 36 -64 73 -171 77 -223 l3 -44 -198 -3 c-213 -3 -237 2 -237 44 0 25 -46 94 -80 121 -8 7 -39 24 -69 38 -48 23 -66 26 -171 27 -106 0 -121 -2 -166 -25 -66 -34 -99 -85 -99 -154 0 -85 48 -129 175 -159 30 -7 93 -22 140 -34 47 -12 125 -30 174 -40 283 -60 471 -169 532 -306 30 -68 54 -162 54 -210 0 -114 -63 -291 -127 -359 -144 -152 -387 -224 -712 -211 -84 3 -159 10 -165 15 -6 5 -36 11 -66 13 -51 4 -96 19 -162 54 -14 8 -32 14 -40 14 -7 0 -25 11 -40 25 -15 14 -32 25 -38 25 -9 0 -87 75 -115 112 -51 65 -77 131 -93 241 -9 56 -8 59 14 67 36 14 382 14 398 0 8 -6 24 -38 36 -70 28 -76 84 -133 142 -148 143 -35 242 -41 340 -21 76 15 109 29 141 58 86 78 73 187 -27 236 -58 28 -224 77 -406 120 -137 33 -308 94 -402 145 -30 16 -78 54 -106 84 -66 70 -85 132 -86 276 0 126 17 187 80 276 113 161 289 263 494 288 55 6 298 -3 368 -14z m2607 -10 c279 -89 463 -301 544 -625 10 -40 22 -78 25 -84 11 -17 7 -320 -3 -355 -6 -17 -19 -63 -31 -103 -49 -174 -164 -359 -281 -455 -69 -57 -181 -107 -306 -139 -98 -25 -135 -29 -247 -29 -127 0 -323 27 -350 49 -6 5 -29 14 -51 21 -79 25 -196 105 -254 174 -14 15 -29 33 -35 40 -33 34 -115 189 -144 271 -17 46 -40 144 -47 200 -12 100 -8 298 10 380 63 302 261 550 514 646 87 33 140 38 371 35 189 -3 223 -6 285 -26z m-4968 0 c220 -46 377 -150 453 -300 28 -55 90 -244 90 -275 0 -13 -6 -25 -13 -28 -8 -3 -104 -8 -213 -12 -181 -7 -202 -6 -217 9 -9 10 -17 25 -17 34 0 9 -16 50 -36 90 -50 100 -75 117 -204 141 -127 24 -269 -35 -335 -139 -71 -113 -104 -298 -90 -514 8 -124 24 -194 60 -266 35 -69 112 -146 155 -155 19 -4 41 -12 47 -17 7 -6 48 -11 90 -11 91 -2 161 19 214 62 37 31 97 142 106 198 3 19 14 38 25 44 27 14 403 8 418 -7 26 -26 -64 -246 -146 -353 -124 -164 -254 -240 -473 -276 -218 -37 -462 10 -636 121 -100 63 -199 197 -250 336 -62 167 -74 295 -52 553 12 138 20 186 44 257 79 227 273 427 475 489 97 30 149 37 288 38 89 0 152 -5 217 -19z m6923 -11 c189 -66 315 -191 340 -336 8 -48 10 -260 8 -723 l-3 -655 -205 0 -205 0 -6 60 c-4 33 -7 281 -8 550 -1 270 -5 517 -10 550 -5 35 -21 81 -38 110 -24 42 -40 56 -98 84 -66 33 -75 35 -167 34 -78 -2 -105 -6 -140 -24 -96 -49 -155 -119 -188 -225 -26 -81 -36 -288 -39 -808 -1 -176 -4 -322 -7 -325 -3 -3 -95 -7 -204 -9 -196 -3 -199 -3 -210 19 -15 28 -25 1163 -13 1479 l8 215 203 1 c233 2 226 4 217 -88 -8 -69 5 -112 33 -116 12 -2 22 1 22 6 0 6 24 36 53 68 116 127 226 166 452 160 114 -3 152 -8 205 -27z m-5760 -9 c12 -20 12 -1369 0 -1406 l-11 -31 -82 -2 c-45 -1 -138 -8 -206 -16 -69 -8 -127 -12 -130 -9 -3 3 -7 339 -9 746 l-3 740 217 -4 c160 -4 218 -8 224 -18z m2418 -832 c2 -777 1 -847 -14 -859 -13 -11 -65 -15 -214 -17 -183 -3 -198 -2 -205 15 -10 23 -16 1417 -7 1578 l7 120 55 6 c30 3 127 5 215 4 l160 -2 3 -845z m-9770 303 c22 -6 43 -18 46 -27 17 -44 27 -257 21 -444 -4 -113 -8 -207 -10 -210 -2 -3 -8 -59 -14 -125 -11 -115 -35 -266 -68 -425 -8 -41 -19 -93 -23 -115 -16 -79 -60 -241 -75 -275 -8 -19 -19 -55 -26 -80 -6 -25 -21 -67 -34 -95 -20 -46 -59 -137 -88 -210 -37 -92 -185 -377 -199 -383 -5 -2 -8 -8 -8 -13 0 -38 -264 -383 -392 -513 -60 -60 -108 -113 -108 -117 0 -5 -3 -9 -8 -9 -4 0 -43 -34 -87 -75 -43 -41 -84 -75 -91 -75 -6 0 -22 -10 -35 -23 -13 -13 -44 -37 -69 -53 -25 -17 -73 -49 -106 -72 -34 -23 -64 -39 -68 -35 -3 3 -6 2 -6 -4 0 -16 -153 -108 -184 -110 -5 -1 -13 -8 -18 -17 -5 -9 -14 -16 -21 -16 -19 0 -117 -43 -117 -51 0 -4 -14 -10 -31 -14 -17 -4 -54 -17 -83 -30 -144 -63 -525 -161 -696 -179 -77 -8 -221 -26 -315 -39 -115 -15 -672 -16 -699 0 -11 6 -21 19 -23 29 -36 219 -42 425 -17 707 14 171 22 230 58 437 27 155 116 467 167 585 4 11 23 58 40 105 49 129 229 481 310 605 201 306 410 532 704 761 251 196 486 323 785 425 102 34 202 66 223 71 20 4 54 12 75 17 129 33 166 41 247 55 133 24 254 38 400 45 194 9 596 4 643 -8z m7139 -1157 l51 -5 4 -47 c17 -185 -81 -416 -238 -562 -74 -69 -170 -131 -244 -156 -113 -40 -302 -58 -328 -32 -17 17 -15 188 3 260 33 124 99 234 217 359 52 56 149 120 227 150 78 31 202 44 308 33z m-4701 -375 c9 -9 60 -149 114 -310 84 -252 128 -378 224 -649 9 -25 19 -52 23 -60 3 -8 29 -85 58 -170 70 -208 173 -496 195 -545 36 -78 193 -565 186 -572 -10 -10 -398 -9 -448 1 -43 8 -60 37 -98 172 -12 43 -28 99 -35 124 -7 25 -19 73 -26 108 -9 50 -16 63 -33 67 -11 3 -221 4 -466 3 -370 -3 -445 -5 -442 -17 1 -7 -3 -23 -11 -35 -7 -11 -21 -52 -31 -91 -24 -98 -64 -232 -85 -285 -15 -38 -22 -45 -53 -52 -20 -4 -53 -6 -74 -4 -22 2 -106 4 -189 5 -82 1 -157 6 -165 11 -13 8 -7 31 37 157 28 81 63 180 78 218 15 39 54 147 87 240 72 202 86 240 102 280 17 41 35 91 52 150 9 28 22 64 30 82 8 17 14 35 14 41 0 9 26 78 55 147 7 17 16 46 20 65 4 19 11 41 15 50 11 22 65 166 164 435 67 181 136 393 136 418 0 10 10 22 23 27 12 5 135 8 274 7 219 -2 255 -4 269 -18z m8598 15 c13 -5 15 -135 16 -1164 l0 -1159 -34 -6 c-47 -9 -383 -2 -393 8 -13 13 -16 2283 -3 2307 10 19 21 20 205 20 106 0 200 -3 209 -6z m-4824 -590 c6 -15 7 -99 3 -215 -7 -216 6 -193 -118 -203 -38 -3 -79 -8 -90 -10 -11 -2 -40 -7 -64 -11 -62 -10 -152 -52 -179 -83 -40 -46 -70 -124 -82 -207 -6 -44 -13 -285 -16 -535 -3 -250 -7 -461 -10 -468 -3 -10 -44 -12 -196 -7 -106 3 -195 9 -199 13 -26 28 -31 177 -30 877 1 402 4 751 7 776 l6 47 57 5 c97 9 324 -1 333 -15 4 -7 8 -63 8 -124 0 -97 2 -113 19 -128 18 -17 20 -17 39 2 11 11 29 40 39 64 26 58 105 140 176 182 44 26 77 37 140 45 92 13 128 18 140 20 4 0 12 -11 17 -25z m3588 1 c230 -48 402 -194 521 -440 56 -114 66 -152 86 -313 26 -203 -13 -449 -95 -612 -65 -128 -203 -285 -294 -333 -85 -45 -170 -77 -214 -82 -26 -3 -72 -12 -102 -20 -64 -17 -255 -20 -315 -4 -22 6 -71 17 -110 26 -79 16 -84 18 -178 62 -125 58 -218 140 -267 236 -13 25 -29 50 -37 56 -7 6 -13 16 -13 21 0 6 -16 42 -35 82 -45 93 -62 157 -80 291 -19 139 -19 189 0 294 36 207 94 344 201 476 130 159 291 250 492 275 95 12 354 4 440 -15z m-5637 1 c122 -26 206 -83 296 -199 44 -57 70 -23 72 90 1 51 5 64 20 73 12 6 95 10 199 10 155 0 181 -2 186 -16 3 -9 6 -396 6 -860 0 -902 -2 -956 -51 -1119 -32 -106 -64 -161 -137 -234 -99 -98 -236 -156 -440 -187 -88 -13 -355 -7 -446 10 -305 58 -465 176 -526 392 -17 57 -17 66 -4 71 9 3 113 4 231 1 l216 -5 21 -29 c42 -60 102 -112 141 -123 100 -29 274 -23 370 11 43 16 103 75 131 131 25 49 66 236 79 359 7 70 -4 108 -30 108 -17 0 -54 -35 -78 -72 -26 -41 -115 -102 -182 -126 -161 -56 -468 -21 -609 69 -158 100 -277 289 -324 514 -25 119 -21 398 7 523 60 268 243 502 456 581 103 39 282 51 396 27z m3889 -6 c120 -26 255 -90 332 -160 94 -84 172 -245 184 -380 l7 -67 -92 -7 c-101 -8 -262 0 -302 15 -16 6 -32 25 -44 54 -10 24 -26 52 -36 61 -10 9 -16 21 -13 28 9 23 -71 80 -146 104 -40 13 -143 17 -180 8 -14 -4 -35 -8 -46 -10 -36 -5 -117 -48 -141 -75 -73 -82 -125 -279 -125 -471 0 -134 35 -302 78 -376 103 -175 375 -230 499 -100 41 44 53 64 104 178 l29 67 195 -2 c235 -1 236 -2 218 -81 -27 -123 -139 -314 -239 -408 -76 -72 -213 -145 -284 -152 -24 -2 -72 -12 -108 -21 -79 -21 -194 -16 -345 15 -108 22 -105 21 -215 74 -167 82 -286 250 -347 491 -26 102 -28 124 -28 310 0 158 4 217 18 280 36 155 89 267 182 379 44 53 179 166 199 166 6 0 17 5 24 12 19 19 131 59 207 73 113 20 304 18 415 -5z m4195 0 c119 -22 254 -71 330 -119 69 -44 111 -98 138 -175 34 -96 36 -117 42 -606 8 -677 12 -715 72 -775 19 -19 33 -40 31 -47 -4 -10 -60 -13 -244 -13 l-239 0 -12 26 c-7 14 -14 46 -17 71 -7 81 -25 87 -89 30 -77 -70 -194 -138 -272 -159 -127 -35 -270 -47 -311 -26 -10 6 -47 16 -82 22 -76 15 -159 62 -225 127 -88 87 -127 193 -127 349 0 160 48 281 152 382 127 124 228 156 673 214 98 13 174 41 210 79 50 52 52 204 3 242 -28 21 -138 47 -229 55 -89 8 -189 -12 -222 -43 -14 -13 -30 -24 -35 -24 -9 0 -37 -50 -34 -62 1 -5 -3 -8 -8 -8 -6 0 -18 -18 -27 -39 -9 -22 -27 -44 -40 -50 -14 -6 -96 -10 -199 -10 l-176 1 4 76 c8 135 80 260 210 364 91 73 200 112 368 132 58 7 291 -3 355 -14z m-5465 -26 c3 -3 5 -389 5 -857 l0 -852 -190 -3 c-104 -1 -200 0 -213 3 l-23 6 3 850 c3 742 5 851 18 859 15 10 390 4 400 -6z"/>
                    <path d="M7157 5493 c-4 -3 -7 -161 -7 -349 0 -323 1 -344 18 -353 12 -6 126 -9 293 -7 251 2 278 4 328 24 107 42 151 87 188 195 23 65 25 82 20 172 -7 104 -24 169 -58 217 -25 35 -115 82 -187 97 -57 12 -584 16 -595 4z" fill="#121212"/>
                    <path d="M10308 4946 c-56 -20 -110 -72 -158 -151 -40 -66 -51 -104 -54 -190 l-1 -30 355 -3 c322 -2 356 -1 367 14 7 10 10 29 7 43 -32 156 -89 243 -196 297 -46 24 -67 27 -168 31 -82 2 -126 -1 -152 -11z" fill="#121212"/>
                    <path d="M16928 4953 c-26 -7 -67 -22 -90 -34 -44 -22 -108 -76 -108 -92 0 -4 -11 -23 -23 -40 -58 -78 -87 -255 -75 -447 8 -125 12 -151 32 -209 8 -25 13 -48 10 -53 -3 -4 -1 -8 3 -8 5 0 15 -15 21 -34 15 -42 109 -129 166 -155 112 -52 300 -47 391 9 16 10 49 38 72 62 168 172 195 605 52 838 -70 115 -155 162 -304 170 -63 3 -117 1 -147 -7z" fill="#121212"/>
                    <path d="M8339 2693 c-1 -5 -1 -11 0 -15 0 -5 -5 -8 -13 -8 -15 0 -39 -64 -51 -132 -3 -21 -31 -111 -61 -200 -102 -302 -137 -413 -148 -473 -21 -111 -53 -100 283 -103 l294 -2 -7 57 c-3 32 -13 78 -20 103 -12 39 -105 335 -166 525 -10 33 -24 80 -30 104 -23 88 -75 180 -81 144z" fill="#121212"/>
                    <path d="M15573 2278 c-107 -39 -183 -122 -222 -244 -28 -86 -51 -217 -51 -293 0 -130 70 -352 136 -431 53 -62 145 -109 250 -126 53 -8 176 11 224 36 94 48 192 170 213 265 4 17 14 62 22 100 19 88 20 236 1 340 -34 188 -98 285 -224 343 -49 22 -73 26 -172 29 -100 3 -123 0 -177 -19z" fill="#121212"/>
                    <path d="M10210 2266 c-83 -20 -101 -30 -149 -77 -95 -95 -126 -213 -118 -457 4 -141 7 -165 33 -238 63 -173 168 -244 362 -244 245 1 376 174 376 500 1 136 -19 252 -56 330 -32 69 -113 147 -177 171 -70 26 -197 33 -271 15z" fill="#121212"/>
                    <path d="M18430 1695 c-105 -31 -162 -45 -183 -45 -47 0 -218 -49 -261 -74 -103 -60 -138 -215 -76 -336 12 -25 35 -44 76 -65 49 -26 69 -30 133 -30 185 0 351 116 379 265 6 30 13 105 17 167 6 105 5 112 -14 122 -11 6 -21 11 -23 10 -2 0 -23 -7 -48 -14z" fill="#121212"/>
                </g>
            </svg>
        </header>

        <section class="status-grid">
            <div class="card status-item">
                <h2>Bomba</h2>
                <p id="pump-status" class="status-text status-off">APAGADA</p>
            </div>
            <div class="card status-item">
                <h2>Nivel</h2>
                <p class="status-text"><span id="level-m">--</span> <span class="status-value">m</span></p>
            </div>
        </section>
        <section class="card">
            <h2>Estado del Proceso</h2>
            <div class="status-grid">
                <div class="status-item">
                    <h3>Inoculación</h3>
                    <p class="status-text"><span id="inoculation-days">--</span> <span class="status-value">días</span></p>
                </div>
                <div class="status-item">
                    <h3>Aireadores</h3>
                    <div class="aerator-status">
                        <span>1:</span> <span id="aerator1-status" class="status-text">--</span>
                    </div>
                    <div class="aerator-status">
                        <span>2:</span> <span id="aerator2-status" class="status-text">--</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="card">
            <h2>Control Manual</h2>
            <div class="control-group">
                <div class="control-panel">
                    <span>Bomba Principal</span>
                    <label class="switch">
                        <input type="checkbox" id="pump-toggle">
                        <span class="slider round"></span>
                    </label>
                </div>
                <button id="reset-inoculation" class="btn">Reiniciar Conteo de Inoculación</button>
            </div>
        </section>

        <section class="card">
            <h2>Sensores</h2>
            <div class="status-grid" style="gap: 25px 15px;">
                <div class="status-item">
                    <h3>PH</h3>
                    <p class="status-text"><span id="ph-val">--</span> <span class="status-value">pH</span></p>
                </div>
                <div class="status-item">
                    <h3>Oxígeno (DO)</h3>
                    <p class="status-text"><span id="do-val">--</span> <span class="status-value">mg/L</span></p>
                </div>
                
                <div class="status-item">
                    <h3>NH3</h3>
                    <p class="status-text"><span id="nh3-ppm">--</span> <span class="status-value">ppm</span></p>
                </div>
                <div class="status-item">
                    <h3>H2S</h3>
                    <p class="status-text"><span id="s2h-ppm">--</span> <span class="status-value">ppm</span></p>
                </div>
                
                <div class="status-item">
                    <h3>Temp. RS485</h3>
                    <p class="status-text"><span id="temp-rs-c">--</span> <span class="status-value">°C</span></p>
                </div>
                <div class="status-item">
                    <h3>Temp. Ambiente</h3>
                    <p class="status-text"><span id="temp-amb-c">--</span> <span class="status-value">°C</span></p>
                </div>
            </div>
        </section>
        </main>

    <footer>
        <p id="version-info"></p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- IDs de Elementos ---
            const pumpStatusEl = document.getElementById('pump-status');
            const pumpToggleEl = document.getElementById('pump-toggle');
            const inoculationDaysEl = document.getElementById('inoculation-days');
            const resetInoculationBtn = document.getElementById('reset-inoculation');
            const aerator1StatusEl = document.getElementById('aerator1-status');
            const aerator2StatusEl = document.getElementById('aerator2-status');
            const versionInfoEl = document.getElementById('version-info');

            // --- IDs Nuevos y Modificados ---
            const levelMEl = document.getElementById('level-m'); // Reemplaza a flowLpmEl
            const phValEl = document.getElementById('ph-val');
            const doValEl = document.getElementById('do-val'); // ID actualizado
            const nh3PpmEl = document.getElementById('nh3-ppm');
            const s2hPpmEl = document.getElementById('s2h-ppm');
            const tempRsCEl = document.getElementById('temp-rs-c');
            const tempAmbCEl = document.getElementById('temp-amb-c');
            
            const formatValue = (value, decimals = 0, fallback = '--') => {
                if (value === null || typeof value === 'undefined') {
                    return fallback;
                }
                return value.toFixed(decimals);
            };

            const updateStatus = async () => {
                try {
                    const response = await fetch('/api/status');
                    if (!response.ok) throw new Error('Network response was not ok');
                    const data = await response.json();

                    // --- Estado y Proceso ---
                    pumpToggleEl.checked = data.pump_on;
                    pumpStatusEl.textContent = data.pump_on ? 'ENCENDIDA' : 'APAGADA';
                    pumpStatusEl.className = 'status-text ' + (data.pump_on ? 'status-on' : 'status-off');

                    inoculationDaysEl.textContent = data.inoculation_days;

                    aerator1StatusEl.textContent = data.aerator1_on ? 'ON' : 'OFF';
                    aerator1StatusEl.className = 'status-text ' + (data.aerator1_on ? 'status-on' : 'status-off');
                    
                    aerator2StatusEl.textContent = data.aerator2_on ? 'ON' : 'OFF';
                    aerator2StatusEl.className = 'status-text ' + (data.aerator2_on ? 'status-on' : 'status-off');
                    
                    if (data.version) {
                        versionInfoEl.textContent = `Firmware: ${data.version}`;
                    }

                    // --- NUEVA LÓGICA DE SENSORES ---
                    if (data.sensors) {
                        // Grupo Analógico (claves actualizadas)
                        phValEl.textContent = formatValue(data.sensors.analog.ph_value, 2);
                        doValEl.textContent = formatValue(data.sensors.analog.do_mg_l, 2);
                        nh3PpmEl.textContent = formatValue(data.sensors.analog.nh3_ppm, 2);
                        s2hPpmEl.textContent = formatValue(data.sensors.analog.s2h_ppm, 2);

                        // Grupo RS485 (Sin cambios)
                        levelMEl.textContent = formatValue(data.sensors.rs485.level, 2);
                        
                        const tempRSK = data.sensors.rs485.rs485_temperature;
                        const tempRSC = (tempRSK !== null) ? (tempRSK - 273.15) : null;
                        tempRsCEl.textContent = formatValue(tempRSC, 1);
                        
                        const tempAmb = data.sensors.rs485.ambient_temperature;
                        tempAmbCEl.textContent = formatValue(tempAmb, 1);
                    }
                    // --- FIN DE LÓGICA DE SENSORES ---

                } catch (error) {
                    console.error('Error al actualizar estado:', error);
                    pumpStatusEl.textContent = 'ERROR';
                    pumpStatusEl.className = 'status-text status-off';
                    aerator1StatusEl.textContent = 'ERR';
                    aerator2StatusEl.textContent = 'ERR';
                    
                    // Resetear sensores en caso de error
                    levelMEl.textContent = '--';
                    phValEl.textContent = '--';
                    oxigenoValEl.textContent = '--';
                    nh3PpmEl.textContent = '--';
                    s2hPpmEl.textContent = '--';
                    tempRsCEl.textContent = '--';
                    tempAmbCEl.textContent = '--';
                }
            };

            // --- Funciones de Control (SIN CAMBIOS) ---
            const togglePump = async () => {
                try {
                    const response = await fetch('/api/control', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ action: 'toggle_pump' })
                    });
                    if (!response.ok) throw new Error('Control command failed');
                    
                    await updateStatus(); // Actualiza inmediatamente

                } catch (error) {
                    console.error('Error al controlar la bomba:', error);
                }
            };

            const resetInoculation = async () => {
                if (!confirm('¿Estás seguro de que quieres reiniciar el conteo de días de inoculación?')) {
                    return;
                }
                try {
                    const response = await fetch('/api/control', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ action: 'reset_inoculation' })
                    });
                    if (!response.ok) throw new Error('Reset command failed');
                    
                    await updateStatus();

                } catch (error) {
                    console.error('Error al reiniciar el conteo:', error);
                }
            };

            pumpToggleEl.addEventListener('change', togglePump);
            resetInoculationBtn.addEventListener('click', resetInoculation);

            updateStatus();
            setInterval(updateStatus, 3000);
        });
    </script>
</body>
</html>